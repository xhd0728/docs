---
title: "Custom Server"
icon: "puzzle-piece"
---

## Server Function

The `Custom Server` is specifically designed to store user-defined tool functions (`Tool`) that cannot be classified into standard modules such as `Retriever`, `Generation`, or `Evaluation`.

All logical tools that do not belong to core Servers (such as data cleaning, keyword extraction, specific rule-based logic, etc.) can be included in the `Custom Server`.

## Example: Query Extraction Tool in Search-o1

Below is a custom Tool used in the Search-o1 pipeline to extract search query strings from the model's generated answers, specifically the text between `<|begin_search_query|>` and `<|end_search_query|>`:

```python
@app.tool(output="ans_ls->extract_query_list")
def search_o1_query_extract(ans_ls: List[str]) -> Dict[str, List[str]]:

    def get_query(text):
        import re
        pattern = (
            re.escape("<|begin_search_query|>")
            + r"(.*?)"
            + re.escape("<|end_search_query|>")
        )
        matches = re.findall(pattern, text, flags=re.DOTALL)

        if matches:
            query = matches[-1].strip()
            if not query.endswith("?"):
                query += "?"
            return query
        else:
            return "There is no query."

    query = [get_query(answer) for answer in ans_ls]

    return {"extract_query_list": query}
```

A typical application of this Tool is to insert an extraction step after `generation`, for example:

```yaml
pipeline:
  - generation.generate
  - custom.search_o1_query_extract
  - retriever.retriever_search
```